version: '3.8'

services:
  attendance-tracker:
    build: .
    ports:
      - "8080:80"
    environment:
      - NODE_ENV=production
    volumes:
      # Mount models directory if available locally
      - ./public/models:/usr/share/nginx/html/models:ro
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s

  # Optional: Add a backend service (for future implementation)
  # backend:
  #   build: ./backend
  #   ports:
  #     - "3000:3000"
  #   environment:
  #     - NODE_ENV=production
  #     - DB_CONNECTION_STRING=mongodb://mongo:27017/attendance
  #   depends_on:
  #     - mongo
  #   restart: unless-stopped

  # Optional: Add MongoDB (for future backend)
  # mongo:
  #   image: mongo:7
  #   ports:
  #     - "27017:27017"
  #   environment:
  #     - MONGO_INITDB_ROOT_USERNAME=admin
  #     - MONGO_INITDB_ROOT_PASSWORD=password
  #     - MONGO_INITDB_DATABASE=attendance
  #   volumes:
  #     - mongo_data:/data/db
  #   restart: unless-stopped

# volumes:
#   mongo_data: